
# Inferential statistics

In our models, we focussed on a contrast difference of .25 vs. .75. This is because the 0 and 1 contrast difference conditions were different from the other contrast levels: At 0 contrast difference, there was no correct answer and feedback was probabilistic, making those trials hard to compare with the others. At a contrast difference of 1, there was only one stimulus presented, potentially changing the (visual) neural response, introducing a bias to our models which are based on spiking data. Hence, consistently with our models, we compared the behavioural data between a contrast difference of .25 vs. .75 only.

```{r contrast_25_75}
# Reduce data to go trials with an absolute contrast difference of .25 and .75
data_25_75 <- data_wof %>% 
  filter(condition == "go", contrast_diff_abs %in% c(.25, .75))
```


## Response times
```{r response_time_25_vs_75}
data_25_75 %>% 
  
  ggplot(aes(x = factor(contrast_diff_abs), y = response_time_diff, colour = feedback_type_rec)) +
  geom_jitter(alpha = .4) +
  stat_summary(aes(fill = feedback_type_rec), size = 1, shape = 21, colour = "black") +
  theme(legend.position = "top") +
  facet_wrap(~response_rec2) +
  scale_colour_manual("feedback", values = c("darkred", "lightblue3"), labels = c("wrong", "correct")) +
  scale_fill_manual("feedback", values = c("darkred", "lightblue3"), labels = c("wrong", "correct")) +
  labs(title = "Go trial response times", subtitle = "by correct response and contrast difference",
       y = "response time from go cue", x = "absolute contrast difference") +
  my_theme
```

Obviously, response times are different for no-go responses. Also, a no-go response is always wrong. We hence set up a model for go trials where the mice did not make a no-go response with the following predictors: Contrast level (.25 or .75, coded as -.5 and .5) and feedback (wrong or correct, coded as -.5 and .5). We added a random intercept for each mouse.

```{r mm_response_time}
# TO DO: FIX THAT P-VALUES ARE CUT OFF!

data_response_time <- data_25_75 %>% 
  filter(response_rec2 == "other") %>% # filter out no-go responses
  # Recode predictors for mixed model
  mutate(contrast_diff_eff = ifelse(contrast_diff_abs == .25, -.5, .5),
         feedback_eff = ifelse(feedback_type_rec == "punishment", -.5, .5))

mm_response_time <- lmer(response_time_diff ~ contrast_diff_eff * feedback_eff + (1|mouse),
                         data = data_response_time)

tidy(mm_response_time) %>% 
  mutate(p.value = gsub("\\$", "", format_p(p.value, numbers_only = TRUE))) %>% 
  mutate_if(is.numeric, list(~round(., 3))) %>% 
  mutate(term = ifelse(grepl("sd_", term), paste0("sd_", group), term)) %>% 
  select(-group) %>% 
  kable(align = c(rep("l", 2), rep("r", 5))) %>% 
  kable_styling("striped")
```

It seems like overall (i.e. at the mean of correct and wrong responses), there is no effect of contrast difference. There is, however, an effect of feedback: Wrong responses are slower than correct ones (at the mean of a contrast difference .25 and .75). Lastly, there is a strong contrast x feedback interaction: Response times are slower for wrong responses, but only contrast difference of .75.

We run a follow up-model to check for simple effects by changing the coding from -.5 and .5 to 0 and 1. Here, we can confirm that there is a difference between .25 and .75 for wrong responses (which are coded as 0 here). Furthermore, there is an effect of feedback (correct vs. wrong) at a contrast difference of .25 already.

```{r mm_response_time_dummy}
data_response_time <- data_25_75 %>% 
  filter(response_rec2 == "other") %>% # filter out no-go responses
  # Recode predictors for mixed model
  mutate(contrast_diff_eff = ifelse(contrast_diff_abs == .25, 0, 1),
         feedback_eff = ifelse(feedback_type_rec == "punishment", 0, 1))

mm_response_time <- lmer(response_time_diff ~ contrast_diff_eff * feedback_eff + (1|mouse),
                         data = data_response_time)

tidy(mm_response_time) %>% 
  mutate(p.value = gsub("\\$", "", format_p(p.value, numbers_only = TRUE))) %>% 
  mutate_if(is.numeric, list(~round(., 3))) %>% 
  mutate(term = ifelse(grepl("sd_", term), paste0("sd_", group), term)) %>% 
  select(-group) %>% 
  kable(align = c(rep("l", 2), rep("r", 5))) %>% 
  kable_styling("striped")
```
